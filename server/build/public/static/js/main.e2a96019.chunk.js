(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{48:function(e,a,t){e.exports=t(90)},53:function(e,a,t){},54:function(e,a,t){},56:function(e,a,t){},78:function(e,a,t){},83:function(e,a,t){},87:function(e,a,t){},90:function(e,a,t){"use strict";t.r(a);var n=t(0),s=t.n(n),r=t(18),c=t.n(r),o=(t(53),t(5)),l=t(23),i=(t(54),t(6)),u=t.n(i),d=t(93),m=t(92),p=(t(56),t(10)),f=t.n(p),v=function(e){var a=s.a.useState(""),t=Object(o.a)(a,2),n=t[0],r=t[1],c=s.a.useState(""),l=Object(o.a)(c,2),i=l[0],p=l[1],v=s.a.useState(""),h=Object(o.a)(v,2),E=h[0],y=h[1];return s.a.createElement("div",{className:"Start"},s.a.createElement("header",null,s.a.createElement("h1",null,"Attendance")),s.a.createElement(d.a,{onSubmit:function(a){var t;return u.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(a.preventDefault(),a.stopPropagation(),!n||!i){s.next=14;break}return s.prev=3,s.next=6,u.a.awrap(f.a.post("/api/login",{name:n,sessionCode:i}));case 6:t=s.sent,console.log(t),"admin"===n?e.loginAdmin():e.login(n,i),s.next=14;break;case 11:s.prev=11,s.t0=s.catch(3),y(s.t0.response.data.message);case 14:case"end":return s.stop()}}),null,null,[[3,11]])}},s.a.createElement("p",null,E),s.a.createElement(d.a.Group,null,s.a.createElement(d.a.Control,{size:"lg",placeholder:"Enter Name",required:!0,onChange:function(e){return r(e.target.value)}}),s.a.createElement(d.a.Control.Feedback,{type:"invalid"},"Please input your name.")),s.a.createElement(d.a.Group,null,s.a.createElement(d.a.Control,{size:"lg",placeholder:"admin"===n?"Enter Password":"Enter Session Code",required:!0,type:"admin"===n?"password":"",onChange:function(e){return p(e.target.value)}}),s.a.createElement(d.a.Control.Feedback,{type:"invalid"},"Please input the session code.")),s.a.createElement("p",null,"Please turn up your volume."),s.a.createElement(m.a,{className:"Start-Button",size:"lg",variant:"primary",type:"submit"},"Start Scanning")))};t(78);var h=function(){return s.a.createElement("div",{className:"Footer"},"Made with ",s.a.createElement("span",{role:"img","aria-label":"love"},"\ud83d\ude84")," by ",s.a.createElement("a",{href:"https://jamesjlu.com",target:"_blank",rel:"noopener noreferrer"},"James Lu"))},E=t(39),y=t.n(E),g=(t(83),t(95)),k=t(17),b=t.n(k);var S=function(){var e=new b.a.Sound({source:"wave",options:{type:"sine",frequency:523.25,volume:1,attack:0,release:.5}});setTimeout((function(){e.stop()}),200),e.play()},w=function(){var e=new b.a.Sound({source:"wave",options:{type:"sawtooth",frequency:100,volume:.75,attack:0,release:.5}});setTimeout((function(){e.stop()}),200),e.play()},C=function(){var e=new b.a.Sound({source:"wave",options:{type:"sawtooth",frequency:392,volume:.25,attack:0,release:.5}});setTimeout((function(){e.stop()}),200),e.play()},N=function(){var e=new b.a.Sound({source:"wave",options:{type:"sine",frequency:392,volume:2,attack:0,release:.5}});setTimeout((function(){e.stop()}),200),e.play()},x=function(e){var a=s.a.useState("Ready to Scan"),t=Object(o.a)(a,2),n=t[0],r=t[1],c=s.a.useState(""),l=Object(o.a)(c,2),i=l[0],d=l[1],p=s.a.useState("in"),v=Object(o.a)(p,2),h=v[0],E=v[1],k=s.a.useState("ready"),b=Object(o.a)(k,2),x=b[0],j=b[1],O=function(e,a,t){switch(j(e),e){case"ready":r("Ready to Scan"),d("");break;case"scanning":r("Please Wait..."),N();break;case"exists":r(a),d("Checked-".concat(h," at ").concat(t)),C();break;case"valid":r(a),d("Successfully checked-".concat(h)),S();break;case"no-in":r("".concat(a," Not Scanned")),d("Please check in first."),w();break;case"invalid":r("Invalid Code"),w();break;default:r("Error"),w()}};return s.a.createElement("div",{className:"Scan"},s.a.createElement("nav",{className:"Scan-Nav"},s.a.createElement(g.a,{variant:"pills",justify:!0,activeKey:h},s.a.createElement(g.a.Item,null,s.a.createElement(g.a.Link,{eventKey:"in",onSelect:function(){return E("in")}},"Check-In")),s.a.createElement(g.a.Item,null,s.a.createElement(g.a.Link,{eventKey:"out",onSelect:function(){return E("out")}},"Check-Out")))),s.a.createElement(y.a,{className:"ScanWindow",delay:1e3,onScan:function(a){var t;return u.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(!a||"ready"!==x){n.next=6;break}return O("scanning"),n.next=4,u.a.awrap(f.a.post("/api/checkin",{studentID:a,scanner:e.name,sessionCode:e.sessionCode,flag:h}));case 4:t=n.sent,setTimeout((function(){200===t.status?"valid"===t.data.result?O("valid",t.data.name):"exists"===t.data.result?O("exists",t.data.name,t.data.detail):"invalid"===t.data.result?O("invalid"):"no-in"===t.data.result&&O("no-in",t.data.name):O("error"),setTimeout((function(){O("ready")}),2e3)}),500);case 6:case"end":return n.stop()}}))},onError:function(e){return console.log(e)}}),s.a.createElement("div",{className:"Result ".concat(function(){switch(x){case"valid":return"Positive";case"invalid":case"no-in":return"Negative";case"exists":return"Neutral";default:return""}}())},n,s.a.createElement("div",{className:"Detail"},i)),s.a.createElement(m.a,{className:"Admin-Button",variant:"outline-secondary",onClick:function(){return e.back()}},"Go Back"))},j=t(96),O=t(94),A=t(44),_=t.n(A),B=t(45),P=t.n(B),q=(t(87),function(e){var a=s.a.useState([]),t=Object(o.a)(a,2),n=t[0],r=t[1],c=s.a.useState({}),l=Object(o.a)(c,2),i=l[0],p=l[1],v=s.a.useState({}),h=Object(o.a)(v,2),E=h[0],y=h[1],g=s.a.useState([]),k=Object(o.a)(g,2),b=k[0],S=k[1],w=s.a.useState(!1),C=Object(o.a)(w,2),N=C[0],x=C[1],A=function(){var e,a,t,n,s,r,c,o;return u.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,u.a.awrap(f.a.get("/api/attendance"));case 2:for(e=l.sent,a={},t=!0,n=!1,s=void 0,l.prev=7,r=e.data[Symbol.iterator]();!(t=(c=r.next()).done);t=!0)o=c.value,a[o.session_date]||(a[o.session_date]={}),a[o.session_date][o.student_id]||(a[o.session_date][o.student_id]=[]),a[o.session_date][o.student_id].push(o);l.next=15;break;case 11:l.prev=11,l.t0=l.catch(7),n=!0,s=l.t0;case 15:l.prev=15,l.prev=16,t||null==r.return||r.return();case 18:if(l.prev=18,!n){l.next=21;break}throw s;case 21:return l.finish(18);case 22:return l.finish(15);case 23:y(a);case 24:case"end":return l.stop()}}),null,null,[[7,11,15,23],[16,,18,22]])};s.a.useEffect((function(){!function(){var e,a,t,n,s,c,l,i,d,m,v;u.a.async((function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,u.a.awrap(Promise.all([f.a.get("/api/sessions"),f.a.get("/api/students")]));case 2:for(e=h.sent,a=Object(o.a)(e,2),t=a[0],n=a[1],A(),r(t.data),s={},c=!0,l=!1,i=void 0,h.prev=12,d=n.data[Symbol.iterator]();!(c=(m=d.next()).done);c=!0)v=m.value,s[v.id]=v;h.next=20;break;case 16:h.prev=16,h.t0=h.catch(12),l=!0,i=h.t0;case 20:h.prev=20,h.prev=21,c||null==d.return||d.return();case 23:if(h.prev=23,!l){h.next=26;break}throw i;case 26:return h.finish(23);case 27:return h.finish(20);case 28:p(s);case 29:case"end":return h.stop()}}),null,null,[[12,16,20,28],[21,,23,27]])}()}),[]);return s.a.createElement("div",{className:"Admin"},s.a.createElement("section",null,s.a.createElement("h1",null,"Sessions"),s.a.createElement(d.a.Group,null,s.a.createElement(m.a,{variant:"outline-primary",onClick:function(){return A()}},"Update Attendance")),s.a.createElement(O.a,null,n.map((function(e){return s.a.createElement(j.a,{key:e.date,style:{textAlign:"left"}},s.a.createElement(O.a.Toggle,{as:j.a.Header,eventKey:e.date,style:{cursor:"pointer"}},e.date," - ",e.passcode),s.a.createElement(O.a.Collapse,{eventKey:e.date},s.a.createElement(j.a.Body,null,s.a.createElement("div",{className:"Admin-NameCategory"},s.a.createElement("h4",null,"Checked-In"),s.a.createElement("div",{className:"Admin-Nameset"},(a=e.session_id,E[a]?Object.values(E[a]).reduce((function(e,a){if(1===a.length){var t=i[a[0].student_id];e.push(s.a.createElement("p",{key:t.id,className:"Admin-Name"},t.firstname," ",t.lastname))}return e}),[]):null))),s.a.createElement("div",{className:"Admin-NameCategory"},s.a.createElement("h4",null,"Checked-Out"),s.a.createElement("div",{className:"Admin-Nameset"},function(e){return E[e]?Object.values(E[e]).reduce((function(e,a){if(2===a.length){var t=i[a[0].student_id];e.push(s.a.createElement("p",{key:t.id,className:"Admin-Name"},t.firstname," ",t.lastname))}return e}),[]):null}(e.session_id))))));var a}))),s.a.createElement(m.a,{className:"Admin-Button",onClick:function(){return function(){var e,a,t,s,c;return u.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,u.a.awrap(f.a.post("/api/createSession"));case 2:if(200===(e=o.sent).status){for(a=P()().format("dddd, YYYY-MM-DD"),console.log(a),t=[],s=!1,c=0;c<n.length;c++)n[c].date===a?(t.push({date:a,passcode:e.data.code}),s=!0):t.push(n[c]);s||t.push({date:a,passcode:e.data.code}),r(t)}else console.log("Try Again");case 4:case"end":return o.stop()}}))}()}},"Create Session")),s.a.createElement("section",null,s.a.createElement("h1",null,"Students"),s.a.createElement("div",null,s.a.createElement(d.a,{className:"Admin-Form"},s.a.createElement(d.a.Control,{onChange:function(e){var a=e.target.files;1!==a.length&&console.log("error");var t=a[0];t.name.endsWith(".csv")||console.log("not csv");_.a.parse(t,{complete:function(e){var a=e.data;a.length<1&&console.log("empty"),1===a.length&&console.log("no content"),console.log(e),S(e.data)},skipEmptyLines:!0,keepEmptyRows:!1})},className:"Admin-Upload",type:"file"}),s.a.createElement(m.a,{onClick:function(){var e,a,t;return u.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return x(!0),n.next=3,u.a.awrap(f.a.post("/api/updateStudents",{data:b}));case 3:e=n.sent,a="data:application/pdf;base64,".concat(e.data),t=document.createElement("a"),"qr-codes.pdf",t.href=a,t.download="qr-codes.pdf",t.click(),x(!1);case 11:case"end":return n.stop()}}))},className:"Admin-Upload-Button",disabled:N||0===b.length},"Upload")))),s.a.createElement(m.a,{className:"Admin-Button",variant:"outline-secondary",onClick:function(){return e.back()}},"Go Back"))}),T=function(e,a){switch(a.type){case"show-admin":return Object(l.a)({},e,{appState:"admin",name:"admin"});case"show-home":return Object(l.a)({},e,{appState:"start",name:"",sessionCode:""});case"start-session":return Object(l.a)({},e,{appState:"scan",name:a.name,sessionCode:a.sessionCode});default:return e}},I={appState:"start",name:"",sessionCode:""};var D=function(){var e=s.a.useReducer(T,I),a=Object(o.a)(e,2),t=a[0],n=a[1],r=function(){n({type:"show-home",name:"",sessionCode:""})};return s.a.createElement("div",{className:"App"},"start"!==t.appState?null:s.a.createElement(v,{login:function(e,a){return n({type:"start-session",name:e,sessionCode:a})},loginAdmin:function(){return n({type:"show-admin"})}}),"scan"!==t.appState?null:s.a.createElement(x,{sessionCode:t.sessionCode,name:t.name,back:r}),"admin"!==t.appState||"admin"!==t.name?null:s.a.createElement(q,{back:r}),s.a.createElement(h,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));t(88);c.a.render(s.a.createElement(D,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[48,1,2]]]);
//# sourceMappingURL=main.e2a96019.chunk.js.map